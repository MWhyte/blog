<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[codenerve]]></title><description><![CDATA[Software Development Tutorials]]></description><link>https://codenerve.com/</link><image><url>https://codenerve.com/favicon.png</url><title>codenerve</title><link>https://codenerve.com/</link></image><generator>Ghost 3.25</generator><lastBuildDate>Sat, 18 Jul 2020 23:37:58 GMT</lastBuildDate><atom:link href="https://codenerve.com/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Spring Security - Basic Login Form]]></title><description><![CDATA[<p>In this series, I hope to show you some techniques for using spring security and the broader spring ecosystem to build and develop secure application web servers.</p><p>Today, we’ll be looking at building a basic login form page using:</p><ul><li>Spring Boot</li><li>Spring Security, and</li><li>Thymeleaf</li></ul><blockquote>Source code for this</blockquote>]]></description><link>https://codenerve.com/spring-security-basic-login-form/</link><guid isPermaLink="false">5f1203ad07a62a995513aedb</guid><category><![CDATA[spring]]></category><dc:creator><![CDATA[Michael W]]></dc:creator><pubDate>Thu, 25 Apr 2019 22:20:29 GMT</pubDate><media:content url="https://images.unsplash.com/photo-1489875347897-49f64b51c1f8?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=2000&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ" medium="image"/><content:encoded><![CDATA[<img src="https://images.unsplash.com/photo-1489875347897-49f64b51c1f8?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=2000&fit=max&ixid=eyJhcHBfaWQiOjExNzczfQ" alt="Spring Security - Basic Login Form"><p>In this series, I hope to show you some techniques for using spring security and the broader spring ecosystem to build and develop secure application web servers.</p><p>Today, we’ll be looking at building a basic login form page using:</p><ul><li>Spring Boot</li><li>Spring Security, and</li><li>Thymeleaf</li></ul><blockquote>Source code for this example can be found on github:</blockquote><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://github.com/codenerve-com/spring-security"><div class="kg-bookmark-content"><div class="kg-bookmark-title">codenerve-com/spring-security</div><div class="kg-bookmark-description">An introduction to spring security. Contribute to codenerve-com/spring-security development by creating an account on GitHub.</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt="Spring Security - Basic Login Form"><span class="kg-bookmark-author">codenerve-com</span><span class="kg-bookmark-publisher">GitHub</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://avatars3.githubusercontent.com/u/58404900?s=400&amp;v=4" alt="Spring Security - Basic Login Form"></div></a></figure><hr><p>First off lets briefly cover some of the project files that are of less interest:</p><ul><li><em><em>Application.java</em></em> — contains our main method and the <em><em>@SpringBootApplication </em></em>annotation.</li><li>A CSS stylesheet is located under src/main/resources/static/css/ to make the demo pretty</li><li>Some Thymeleaf HTML templates are located under src/main/resources/ for demo purposes also</li><li>An <em><em>application.properties</em></em> file is located under src/main/resources where we can pass configuration parameters to our spring boot application. A full list of options can be found <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html">here</a></li></ul><hr><h3 id="dependencies">Dependencies</h3><p>As with all Spring boot application’s, there are a number of ‘Starter’ libraries that make it easy to add jars to your classpath.<br>In addition, these can auto-configure various spring beans and behaviours that we can make use of:</p><!--kg-card-begin: html--><script src="https://gist.github.com/MWhyte/1ea949cf86150a80fa3dfb8f5bcf22f8.js"></script><!--kg-card-end: html--><ul><li>spring-boot-starter-parent — brings in all the required spring dependencies and manages there versions</li><li>spring-boot-starter-thymeleaf — adds thymeleaf-spring5 and thymeleaf-extras-java8time dependencies (<a href="http://www.thymeleaf.org/" rel="noopener nofollow">more on thymeleaf</a>)</li><li>spring-boot-starter-security — adds spring-security-config, spring-security-web and spring-aop dependencies</li><li>spring-boot-starter-test — adds spring-boot-test, junit, <a href="http://hamcrest.org/" rel="noopener nofollow">hamcrest</a> and <a href="https://site.mockito.org/" rel="noopener nofollow">mockito</a></li><li>spring-security-test — adds the ability to mock user and user roles</li></ul><h3 id="mvcconfig">MvcConfig</h3><!--kg-card-begin: html--><script src="https://gist.github.com/MWhyte/e4e32de81af96c806d020ddec2fafdfa.js"></script><!--kg-card-end: html--><p>This class implements spring’s <em><em>WebMvcConfigurer </em></em>interface. This allows you to override the method <em><em>addViewControllers</em></em> (as well as others) which is a way to configure simple automated controllers. In this example, we have mapped them to our Thymeleaf views (under src/main/resources).</p><h3 id="websecurityconfig">WebSecurityConfig</h3><!--kg-card-begin: html--><script src="https://gist.github.com/MWhyte/421de0b17b116b59866fd4a7d455f183.js"></script><!--kg-card-end: html--><p>There’s a lot going on in this class as it contains the main security configuration to enable and configure our basic login form.</p><p><strong><strong>@EnableWebSecurity</strong></strong><br>A Marker which allows spring to find your custom web application security configuration</p><p><strong><strong>WebSecurityConfigurerAdapter</strong></strong><br>Another abstract base class that allows you to override certain aspects of spring security’s default configuration. In our case, we are going to override the methods <em><em>configure</em></em> and <em><em>configureGlobal</em></em>.</p><p><strong><strong>configure(HttpSecurity http) method</strong></strong><br>Note the parameter passed to this method. There are several different configure methods. We will be overriding and configuring <em><em>HttpSecurity </em></em>specifically<em><em>.</em></em></p><ul><li><em><em>authorizeRequests()</em></em> — Allows us to configure which resources on our web server to secure. You can see from our example code we have allowed un-secured access to our CSS directory and requested that all other resources are secured and can only be accessed by an authenticated user.</li><li><em><em>formLogin()</em></em> — Tells spring security that we wish to use a login form. We provide the login URL, the URL we want to redirect to if the authentication is successful and finally permit access to the login and logout endpoints.</li><li><em><em>csrf()</em></em> — For now we are disabling cross-site request forgery protection which by default is enabled. We will cover this later in the series.</li></ul><p><strong><strong>configureGlobal method</strong></strong><br>Allows us to autowire an <em><em>AuthenticationManager</em></em> which will be used globally throughout our application. For this example, we are using a basic in-memory approach with one user and one user role.</p><h3 id="thymeleaf-namespace">Thymeleaf namespace</h3><p>A few things to note in our <em><em>login.html</em></em><br>The thymeleaf spring security namespace:</p><pre><code class="language-html">&lt;html xmlns="http://www.w3.org/1999/xhtml"  
xmlns:th="http://www.thymeleaf.org"    
xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"&gt;</code></pre><p>The thymeleaf action which instructs the form to do a POST request to the URL provided (/login):</p><pre><code class="language-html">&lt;form th:action="@{/login}" method="post" class="form login"&gt;</code></pre><p>The thymeleaf if condition can check for URL parameters, error and log out responses and display content if they return true:</p><pre><code class="language-html">&lt;div class="text--center" th:if="${param.error}"&gt;
    Invalid username and password.
&lt;/div&gt;
&lt;div class="text--center" th:if="${param.logout}"&gt;
     You have been logged out.
&lt;/div&gt;</code></pre><p>Full list of what's available on the thymeleaf <a href="http://www.thymeleaf.org/doc/tutorials/2.1/thymeleafspring.html#handling-the-command-object" rel="noopener nofollow">website</a></p><h3 id="demo">Demo</h3><p>To run the demo open the <em><em>Application.java</em></em> class and right click run. In order to start the example, port 8080 will need to be available on your machine. If it is not you can change this default in the application.properties file using:</p><!--kg-card-begin: markdown--><pre><code class="language-html">server.port=8081
</code></pre>
<!--kg-card-end: markdown--><p>Set this to whatever value you wish.</p><figure class="kg-card kg-embed-card"><iframe width="612" height="344" src="https://www.youtube.com/embed/aQ6QTQdCfeQ?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><hr><h3 id="unit-testing">Unit Testing</h3><!--kg-card-begin: html--><script src="https://gist.github.com/MWhyte/e224a5ec49fca7a52dab0b6726e92805.js"></script><!--kg-card-end: html--><p></p><p><strong><strong>@RunWith(SpringRunner.class)</strong></strong><br>Tells JUnit to run unit tests with Spring’s testing support</p><p><strong><strong>@SpringBootTest</strong></strong><br>Run as spring boot app. i.e. load application.properties and spring beans</p><p><strong><strong>@AutoConfigureMockMvc</strong></strong><br>Creates a Test helper class called MockMvc. From this, we can imitate a front-end client making requests to the server.</p><p><strong><strong>@WithMockUser</strong></strong><br>Provides the ability to mock certain users. An authenticated user in our case.</p><p><strong><strong>FormLoginRequestBuilder</strong></strong><br>A utility class that allows us to create a form based login request.</p><h1 id="next">Next</h1><p>Next up, we will be covering spring security’s user roles and the ability to hide and show content on our site based on the user’s permissions.</p><p></p>]]></content:encoded></item></channel></rss>
